# Galling PINN Model Configuration

# Data settings
data:
  base_path: "/root/Documents/GallingModel"
  temperatures: [165, 167.5, 170]
  min_sliding_distance: 0.1  # mm, filter threshold for preprocessing

# Model architecture
model:
  hidden_dims: [64, 128, 64, 32]  # Neural network hidden layer dimensions
  dropout: 0.1                     # Dropout probability

  # Physics parameter initial values
  physics_init:
    k0: 1.0        # Baseline attachment rate [mass/cycle]
    T0: 25.0       # Attachment temperature sensitivity [°C]
    kw: 0.1        # Wear rate constant [dimensionless]
    M0: 10.0       # Baseline critical mass for galling detachment
    Tc: 45.0       # Critical mass temperature sensitivity [°C]
    alpha: 0.2     # Retention fraction after galling detachment [0.1-0.3]

# Training settings
training:
  # Stage 1: Neural network pre-training (supervised learning)
  stage1:
    n_epochs: 50
    batch_size: 32
    learning_rate: 0.001
    weight_decay: 1.0e-5
    scheduler:
      factor: 0.5          # LR reduction factor
      patience: 10         # Epochs without improvement before LR reduction
      min_lr: 1.0e-6       # Minimum learning rate

    # Early stopping
    early_stopping:
      patience: 15         # Epochs without improvement before stopping
      min_delta: 1.0e-4    # Minimum change to qualify as improvement

  # Stage 2: Joint physics-informed training
  stage2:
    n_epochs: 100
    learning_rate_nn: 0.0001       # Lower LR for NN (to preserve Stage 1 learning)
    learning_rate_physics: 0.001   # Higher LR for physics parameters

    # Loss function weights
    loss_weights:
      w_incycle: 1.0           # In-cycle COF prediction error
      w_physics: 0.5           # Cycle-averaged COF consistency
      w_regularization: 0.1    # Physics parameter regularization

    # Gradient clipping
    grad_clip_norm: 1.0

    # Scheduler for NN
    scheduler_nn:
      factor: 0.7
      patience: 15
      min_lr: 1.0e-7

    # Early stopping
    early_stopping:
      patience: 20
      min_delta: 1.0e-5

# Validation
validation:
  train_val_split: 0.8      # 80% train, 20% validation
  random_seed: 42           # For reproducibility

  # Stratified split by temperature (ensure each temp represented in train/val)
  stratify_by_temp: true

# Output and logging
output:
  model_save_dir: "results/feedforward"
  plot_save_dir: "results/feedforward"
  log_dir: "results/feedforward"

  # Checkpoint saving
  save_every_n_epochs: 10
  save_best_only: true       # Only save checkpoints that improve validation loss

  # Logging
  log_interval: 1            # Log every N epochs
  print_physics_params_every: 10  # Print physics parameters every N epochs

# Hardware
device: "cuda"  # Use "cuda" if available, otherwise "cpu" (auto-detected)

# Reproducibility
seed: 42
deterministic: true  # Use deterministic algorithms (may be slower)
